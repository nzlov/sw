# sw

## 协议

数据格式`json`.

### ws 结构

- login

```
{
    "t":"l",
    "i":"",                   // 消息id保证短时唯一
    "u":"",                   // 用户id
    "m":"",                   // 客户端唯一标志 客户端生成保证唯一
    "tk":"",                  // 验证token
    "ts": 0                   // 客户端时间戳
}
```

- tag

```
{
    "t:"t",
    "i":"",                        // 消息id保证短时唯一
    "d":{
        "aa":true,                 // 注册`aa`
        "bb":false                 // 取消`bb`
    }
}
```

- ack

```
{
    "t":"a",
    "i":"",                     // 消息id保证短时唯一
    "id":[]                     // 消息id列表
}
```

- message

```
{
    "t":"m",
    "ms":[{              // 消息列表
        "id": "",
        "ts":0,
        "data":""
    }]
}
```

- resp

```
{
    "t":"r",
    "i":"",                     // 请求的消息id
    "rt":"",                    // 回复的请求类型
    "c": "0",                   // 状态 0 成功 1 失败
    "m":""                      // 失败信息
}
```

### Code

- 0 成功
- 1000 失败

### Token

给定`secret`,使用`user`,`timestamp`,`secret`进行签名。

#### 加密方法

- HMACMD5
- HMACSHA1
- HMACSHA256
- MD5

### Admin

所有接口必传`sign`,`ts`

#### Sign 方式

给定`secret`,使用`secret`,`data`,`ts`进行签名。

#### Push

```
{
    "d":"",                   // 内容
    "us": [],                 // 目标用户
    "ts": [],                 // 标签目标
    "e":{}                    // 扩展数据
}
```
